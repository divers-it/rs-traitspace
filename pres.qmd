---
title: "Angiosperm reproductive strategies"
subtitle: "02/10/2023"
author: "Andrew Helmstetter"
format: 
  revealjs:
    theme: [default, custom.scss]
editor: visual
---

## Introduction

::: {.incremental}
* Angiosperms have an exceptional diversity of breeding systems
  + hermaphroditism-dioecy, outcrossing-selfing
* Breeding systems are highly labile and impact many ecological & evolutionary processes
* Simple trait associations are known
:::

. . . 


:::: {.columns}

::: {.column width="50%"}

![](figures/phoenix.png){fig-align="center" width=40%}

:::

::: {.column width="50%"}

![](figures/trago.png){fig-align="center" width=40%}

:::

::::

## Introduction

::: {.incremental}

* However, these only explain part of the variation seen in the wild.
* Can we use multi-trait approaches to identify more integrated reproductive strategies?
  + Defined by groups of traits, or 'syndromes'
  + Inspired by Grime's C-S-R theory

:::

. . .

![](figures/csr.jpg){fig-align="center" width=20%}

## Introduction

::: {.incremental}
* Multi-trait approaches are commonly used in functional ecology but less so in evolutionary biology.
* Likewise, evolutionary perspectives are not often taken in functional ecology studies
* Combinations of traits can influence patterns of species diversification (Helmstetter et al. 2023, Anderson et al. 2023)
:::

## Introduction

::: {.incremental}
* Moving from a static to a dynamic viewpoint
  + Not just fitness in a given environment but the product of a complex macroevolutionary process
:::

. . .

![](figures/phy.png){fig-align="center" width=33%}

## Introduction

:::: {.columns}

::: {.column width="50%"}

::: {.incremental}

* Plant functional traits are typically based on a handful of vegetative traits (e.g. Diaz et al. 2016)
* How does including reproductive traits change things?

:::

:::

::: {.column width="50%"}

![](figures/diaz_fig2.jpg){fig-align="center"}

:::

::::


<!-- Input data set -->

## Our data set {.center}

```{css}
.center h2 {
  text-align: center;
}
```

## Two new traits added!

::: {.incremental}
1. Seed mass
2. Dispersal split into:
    i) dispersal distance
    ii) dispersal mode
    
:::

## [Data set completion (pre-clean)]{.r-fit-text}

![](figures/5_missing_data_pre_clean.png){fig-align="center"}

* 26 traits, 363 species, 25% missing data

## [Data set completion (post-clean)]{.r-fit-text}

![](figures/5_missing_data_post_clean.png){fig-align="center"}

* 21 traits, 360 species, 12.5% missing data

## Exploring the trait space {.center}

```{css}
.center h2 {
  text-align: center;
}
```


## Building distance matrices

::: {.incremental}
* Gower's distance
  + Deals with missing data
  + Different types of data (qualitative and quantitative)
:::

## [Missing data imputation using phylogeny]{.r-fit-text}

:::: {.columns}

::: {.column width="50%"}

::: {.incremental}
* missForest()
* Our 21 traits + new traits representing phylogenetic distance between species
:::

:::

::: {.column width="50%"}

::: {.incremental}
![](figures/8_scatterplot_dist_missing_vs_imputed.png){fig-align="center"}
:::

:::

::::

## [How does one-hot encoding affect distances?]{.r-fit-text}

![](figures/one_hot_8_scatterplot_dist_og_vs_one_hot.png){fig-align="center"}

## [Our species in the 'classic' functional trait space of Diaz et al.]{.r-fit-text}

![](figures/8.3_scatterplot_diaz_vs_divers.png){fig-align="center"}

## [Principal Coordinate Analysis (PCoA)]{.r-fit-text}

![](figures/8_scatterplot_pcoa_density_polygon.png){fig-align="center"}

## [Visualizing how traits are correlated with axes using 'loadings']{.r-fit-text}

![](figures/one_hot_13_scatterplot_pcoa_loadings_altered.png){fig-align="center"}

## [Visualizing how traits are correlated with axes using 'loadings']{.r-fit-text}

![](figures/one_hot_13_scatterplot_pcoa_loadings_axes_3_4.png){fig-align="center"}

## [Trait space quality comparisons]{.r-fit-text}

![](figures/9_dimensionality_no_axes.png){fig-align="center"}

<!-- Clustering methods -->

## Clustering to define reproductive strategies {.center}

```{css}
.center h2 {
  text-align: center;
}
```


## Clustering species

::: {.incremental}
* Clustering can be used to group species together
* Many different methods available
* = many different results available!
:::

## 1. Hierarchical clustering

![](figures/11_dendrograms_ward2_coloured_by_cluster.png){fig-align="center"}

## 1. Hierarchical clustering

![](figures/11_scatterplot_pcoa_wardD2_k3_coloured_by_cluster.png){fig-align="center"}

## 2. K-prototypes

![](figures/11.1_scatterplot_pcoa_kpro_k5_coloured_by_cluster.png){fig-align="center"}

## 3. Partition around medoids (PAM)

![](figures/11.2_scatterplot_pcoa_pam_k3_coloured_by_cluster.png){fig-align="center"}

## 4. Density peak

![](figures/11.4_scatterplot_pcoa_dens_k4_coloured_by_cluster.png){fig-align="center"}

<!-- Reproductive strategies -->

## 1. Hierarchical clustering

![](figures/11_scatterplot_pcoa_wardD2_k3_coloured_by_cluster.png){fig-align="center"}

## [Characteristics of clusters (qualitative)]{.r-fit-text}

![](figures/11_stacked_barplots_wardD2_traits_by_cluster.png){fig-align="center"}

## [Characteristics of clusters (quantitative)]{.r-fit-text}

![](figures/11_boxplots_wardD2_traits_by_cluster.png){fig-align="center"}

## [Functional diversity indices of clusters]{.r-fit-text}

```{r, echo=FALSE, results='asis'}
library(knitr)
library(kableExtra)
tr<-read.csv(file = here::here("outputs/10_mfd_indices_wardD2_k3.csv"),row.names=1)
kable(tr) %>% kable_styling(font_size = 26)
```

## Cluster summary

::: panel-tabset

### Cluster 1

* predominantly herbaceous, monomorphic species
* many species have extreme traits (near edge of cluster) (Fdiv)

### Cluster 2

* predominantly woody, dimorphic species with small, dull flowers
* species are quite dissimilar within cluster (MPD, NND)
* Species in cluster and distinct from other species in global pool  (FDis,Fspe, Fori)

### Cluster 3

* predominantly woody, monomorphic species
* Close to the centre of the trait space (FDis)
* species are similar to each other within cluster (NND, MPD)
* functional space filled by cluster is small (Fric)

:::

<!-- Robust groups -->

## [Choosing the number of clusters]{.r-fit-text}

::: {.incremental}
* Choice of k (number of clusters) can be quite arbitrary
* Values of k vary among different approaches
+ And among selection criteria
:::

## [How are clusters related when changing values of k?]{.r-fit-text}

![](figures/11.2_sankey_pam.png){fig-align="center"}

## [Robust groups: species consistently stick together]{.r-fit-text}

![](figures/11.1_sankey_kpro.png){fig-align="center"}

## [Clusters and robust groups (PAM)]{.r-fit-text}

::: {.incremental}
* Uniform Manifold APproximation (UMAP)
* Better takes into account local structure
* Good for visualizing non-linear relationships
:::

## [Clusters and robust groups (PAM)]{.r-fit-text}

![](figures/11.2_scatterplot_umap_pam_coloured_by_robust.png){fig-align="center"}

## [Characteristics of robust groups (qualitative)]{.r-fit-text}

![](figures/11.2_robust_stacked_barplots.png){fig-align="center"}

## [Characteristics of robust groups (quantitative)]{.r-fit-text}

![](figures/11.2_robust_boxplots.png){fig-align="center"}

## [What about the 'wandering' species?]{.r-fit-text}

::: {style="font-size: 75%;"}

* Typically abiotically pollinated, monomorphic, herbaceous species (grasses)

::: 

![](figures/11.2_scatterplot_pcoa_pam_coloured_by_robust.png){fig-align="center"}

## [Clustering similarities and differences]{.r-fit-text}

::: {.incremental}
* Reproductive strategies can be broadly defined by two axes:
  + Woody vs herbaceous (and their correlates)
  + Unisexual vs bisexual flowers (and their correlates)
* Other traits like dispersal, mating system, symmetry split groups at finer scale
  + Typically associated with PCoA axes 3+
* However, these traits vary among clustering approaches so may not be 'strategy defining'
:::

## Some evolutionary explorations {.center}

```{css}
.center h2 {
  text-align: center;
}
```


## [Phylogenetic signal and transition rates]{.r-fit-text}

::: {.incremental}
* Transition rates reconstructed using an Equal Rates model per one-hot trait
  + Rates were relatively high except for traits with high tip ratio bias
* Phylogenetic signal estimated using Delta and Lambda/k
  + 17/35 one-hot traits showed significant levels of phylogenetic signal
  + But generally not strong
:::

## 

![](figures/scatterplot_signal_transition_rate.png){fig-align="center"}

## The evolutionary history of reproductive strategies  {.center}

```{css}
.center h2 {
  text-align: center;
}
```

##

![](figures/figure3_phylo.png){fig-align="center"}

## Simulating data sets using the phylogenetic tree {.center}

```{css}
.center h2 {
  text-align: center;
}
```

## [Quantitative and qualitative data]{.r-fit-text}

::: {.incremental}
* We fit OU / Mk 'ARD' models to each of our traits
* Used these model parameters and the tree to simulate new data sets 
* Simulate 1000 data sets
:::

## [Comparing empirical simulated distance matrices]{.r-fit-text}

![](figures/scatterplots_pairwise_distances.png){fig-align="center"}

## [Eigenvalues of empirical vs simulated data sets]{.r-fit-text}

![](figures/observed_vs_simulated_eigenvalues.png){fig-align="center"}

## [Important traits in simulated data sets]{.r-fit-text}


:::: {.columns}

::: {.column width="50%"}

::: {.incremental}
* Some traits e.g. woodiness often appear on the more important PCoA axes
  + Traits with low tip bias 
:::

:::

::: {.column width="50%"}

![](figures/pcoa_sim_ex1.png){width=80%}

:::

::::

## Conclusions

::: {.incremental}
* Three major 'eco-evolutionary strategies'
  + Pre-zygotic aspects of reproduction that link ecological strategies to evolutionary processes
* Traits relating to woodiness & sexual system play a defining role
  + other traits e.g. dispersal, pollination , symmetry act at second level
  + Mating system appears less important at angiosperm scale
* Reproduction adds a new dimension to typical trait space
:::
